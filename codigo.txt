//Realice la carga de la base de datos con al menos 15 empleados de diferentes cargos, cree un gerente y por lo menos un empleado de los cargos subyacentes, teniendo en cuenta que la mayorÃ­a son empleados.


LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Storm-engine/taller3/refs/heads/main/empleados.csv' AS row
CREATE (:Empleado {
  codigo_empresarial: row.codigo_empresarial,
  nombre: row.nombre,
  apellido: row.apellido,
  edad: toInteger(row.edad),
  documento: row.documento,
  cargo: row.cargo
});

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Storm-engine/taller3/refs/heads/main/jefes.csv' AS row
MATCH (j:Empleado {codigo_empresarial: row.jefe})
MATCH (s:Empleado {codigo_empresarial: row.subordinado})
CREATE (j)-[:JEFE_DE]->(s);


//

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Storm-engine/taller3/refs/heads/main/post.csv' AS row
CREATE (:Post {
  id_post: row.id_post,
  titulo: row.titulo,
  descripcion: row.descripcion,
  fecha: row.fecha
});

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Storm-engine/taller3/refs/heads/main/post_autor.csv' AS row
MATCH (e:Empleado {codigo_empresarial: row.codigo_empresarial})
MATCH (p:Post {id_post: row.id_post})
CREATE (e)-[:PUBLICA]->(p);

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Storm-engine/taller3/refs/heads/main/comentarios.csv' AS row
MATCH (p:Post {id_post: row.id_post})
MATCH (c:Empleado {codigo_empresarial: row.codigo_empleado})
CREATE (c)-[:COMENTA {fecha: row.fecha, texto: row.texto}]->(p);

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Storm-engine/taller3/refs/heads/main/amigos.csv' AS row
MATCH (a:Empleado {codigo_empresarial: row.codigo_empleado1})
MATCH (b:Empleado {codigo_empresarial: row.codigo_empleado2})
MERGE (a)-[:AMIGO_DE {fecha: row.fecha}]->(b)
MERGE (b)-[:AMIGO_DE {fecha: row.fecha}]->(a);

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Storm-engine/taller3/refs/heads/main/reportes.csv' AS row
MATCH (r:Empleado {codigo_empresarial: row.codigo_reportado})
MATCH (q:Empleado {codigo_empresarial: row.codigo_reportante})
CREATE (r)-[:REPORTADO_POR {
  fecha: row.fecha,
  motivo: row.motivo
}]->(q);
